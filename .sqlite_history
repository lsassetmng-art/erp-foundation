exit
ls
,help
.helr
ls
quit
drop view if exists v_outbox_progress;

create view v_outbox_progress as
select
  entity_type,        -- 'ORDER' / 'SHIPPING' / 'BILLING' / 'RETURN'
  entity_key,         -- order_no / shipping_no / billing_no
  count(*)            as pending_count,
  max(retry_count)    as max_retry,
  min(status)         as min_status
from outbox
where status in ('PENDING', 'FAILED')
group by entity_type, entity_key;
exit
sqlite3
exit
